<div fxLayout="row wrap" fxLayoutAlign="center center">
  <app-title fxFlex="100" [title]="'PM Tasks'"></app-title>
</div>

<!-- <div fxLayout="row wrap" fxLayoutAlign="center center" class="mt-3">
  <div fxFlex="100" fxFlex.gt-xs="95">
    <div fxLayout="row wrap" fxLayoutAlign="end stretch">
      <div>
        <button mat-button class="btn-add" (click)="add()" style="color: black">
          <img src="assets/img/master-machine/add-file.png" class="btn-img-add" />
          เพิ่มข้อมูล
        </button>
      </div>
    </div>
  </div>
</div> -->

<div fxLayout="row wrap" fxLayoutAlign="center center" class="mt-3">
  <div fxFlex="100" fxFlex.gt-xs="95" fxLayoutAlign="space-between center">
    <mat-form-field fxFlex="40" appearance="outline" floatLabel="always" class="btn-set">
      <mat-label>ค้นหา</mat-label>
      <input matInput (keyup)="applyFilter($event)" #input>
    </mat-form-field>
    <mat-form-field fxFlex="40" appearance="outline" floatLabel="always" class="btn-set">
      <mat-label>Group</mat-label>
      <mat-select [(ngModel)]="groupSelected" (ngModelChange)="onChangeGroup()">
        <mat-option [value]="0">
          All
        </mat-option>
        <mat-option *ngFor="let group of groupOption" [value]="group">
          {{group}}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div fxFlex="100" fxFlex.gt-xs="95" fxLayout="row wrap" fxLayoutAlign="space-between start"
    class="mat-elevation-z8 overflow-auto">
    <table fxFlex="100" mat-table [dataSource]="dataSource" matSort class="table-custom">

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="capitalize text-nowrap text-black font-bold"> </th>
        <td mat-cell *matCellDef="let row" class="text-nowrap">
          <div fxLayout="row nowrap" fxLayoutAlign="center center" fxLayoutGap="5">
            <mat-slide-toggle [(ngModel)]="row.active" (ngModelChange)="onChangeActive(row)" class="text-gray-500"
              [ngClass]="{'text-green': row.active}">Active</mat-slide-toggle>
            <button mat-icon-button color="primary" (click)="onEdit(row)">
              <mat-icon>edit</mat-icon>
            </button>
            <!-- <button mat-icon-button color="warn">
              <mat-icon>delete</mat-icon>
            </button> -->
          </div>
        </td>
      </ng-container>


      <ng-container matColumnDef="no" sticky>
        <th mat-header-cell *matHeaderCellDef mat-sort-header> no </th>
        <td mat-cell *matCellDef="let row" class="font-semibold text-blue-500 text-nowrap"> {{row.no}}
        <ng-container *ngIf="groupSelected!==0">
          <span title="up" style="cursor: pointer;" (click)="onUp(row)">⬆️</span> <span title="down" style="cursor: pointer;" (click)="onDown(row)">⬇️</span>
        </ng-container>

        </td>
      </ng-container>

      <ng-container matColumnDef="customer" sticky>
        <th mat-header-cell *matHeaderCellDef mat-sort-header> customer </th>
        <td mat-cell *matCellDef="let row" class="font-semibold text-blue-500"> {{row.customer}} </td>
      </ng-container>

      <ng-container matColumnDef="province">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> province </th>
        <td mat-cell *matCellDef="let row"> {{row.province}} </td>
      </ng-container>

      <ng-container matColumnDef="district">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> district </th>
        <td mat-cell *matCellDef="let row"> {{row.district}} </td>
      </ng-container>

      <ng-container matColumnDef="machine">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> machine </th>
        <td mat-cell *matCellDef="let row"> {{row.machine}} </td>
      </ng-container>

      <ng-container matColumnDef="model">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> model </th>
        <td mat-cell *matCellDef="let row"> {{row.model}} </td>
      </ng-container>

      <ng-container matColumnDef="S/N">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> S/N </th>
        <td mat-cell *matCellDef="let row"> {{row['S/N']}} </td>
      </ng-container>

      <ng-container matColumnDef="target">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> target (Month) </th>
        <td mat-cell *matCellDef="let row"> {{row.target}} </td>
      </ng-container>

      <ng-container matColumnDef="lastPM">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> last PM </th>
        <td mat-cell *matCellDef="let row" class="text-nowrap font-semibold "> {{row.lastPM}} </td>
      </ng-container>

      <ng-container matColumnDef="PIC">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> PIC </th>
        <td mat-cell *matCellDef="let row" class="text-nowrap font-semibold text-blue-500"> {{row.PIC}} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" [attr.colspan]="displayedColumns.length">No data matching the filter "{{input.value}}"</td>
      </tr>
    </table>

    <mat-paginator *ngIf="dataSource" fxFlex="100" [pageSizeOptions]="[8, 25, 50, 100,dataSource.filteredData.length]"
      aria-label="Select page of users"></mat-paginator>
  </div>

</div>
